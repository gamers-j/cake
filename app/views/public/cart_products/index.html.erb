<h4>ショッピングカート</h4>
<%= link_to "カートを空にする", cart_products_destroy_all_path, method: :delete, class: "btn btn-danger" %>

<table class="table table-bordered">
  <thead>
    <tr>
      <td>商品名</td>
      <td>単価</td>
      <td>数量</td>
      <td>小計</td>
      <td></td>
    </tr>
  </thead>
  <tbody>
    <% @cart.each do |product| %>
    <tr>
      <td><%= image_tag product.product.get_profile_image(50,50) %><%= product.product.name %></td>
      <td>¥<%= product.add_tax_taxed_price.to_s(:delimited) %></td>
      <td>
      <%= form_with model:[:public,product], url: cart_product_path(product.id), method: :patch do |f| %>
        <%= f.hidden_field :product_id, :value => product.id %>
        <%= f.select :quantity, *[1..10] %>
        <%= f.submit "変更", class: "btn btn-success w-auto" %>
      <% end %>
      </td>
      <td>¥<%= product.subtotal %></td>
      <td><%= link_to "削除する", cart_product_path(product.id), method: :delete, class: "btn btn-danger" %></td>
      <% @total += product.subtotal %>
    <% end %>
    </tr>
  </tbody>
</table>
<table class="table">
  <td>合計金額</td>
  <td>¥<%= @total.to_s(:delimited) %></td>
</table>
<%= link_to "情報入力に進む", new_order_path, class: "btn btn-success btn-lg" %>

